\date{2025-06-27}
\title{Truncation modalities}
\author{samueltoth}
\taxon{module}
\meta{module}{\startverb modalities.instances.Truncation \stopverb}
\import{stt-macros}

%```agda
\agda{
module modalities.instances.Truncation where

open import foundations.Prelude
open import ufAxioms
open import core.Spheres
open import modalities.instances.Localisation
open import modalities.Subuniverses
open import modalities.HigherModality
open import ergonomics.Universal
open import ergonomics.PushoutUniv
}
%```

\subtree[stt-006P]{
\title{#{n}-truncated types}

\p{A type #{X} is #{n-2}-truncated for #{n : \mathbb{N}} when
   it is [null](stt-005G) with respect to #{S^{n-1}}.}


%```agda
\agda{
is-S-1null : âˆ€ {ğ“¤}
                â†’ â„•
                â†’ Type ğ“¤ â†’ Type ğ“¤
is-S-1null zero    = is-null {I = ğŸ™} (const _ _ âˆ…)
is-S-1null (suc n) = is-null {I = ğŸ™} (const _ _ (S n))
}
%```
}

\subtree[stt-006Q]{
\title{Truncation is a [higher modality](stt-000G)}

%```agda
\agda{
Truncation
  : âˆ€ {ğ“¤}
      (n : â„•)
    â†’ HigherModality ğ“¤
Truncation zero = Local-HigherModality {I = ğŸ™}
                             (Î» _ â†’ ! {A = âˆ…}) Î» _ â†’ ğŸ™-is-singleton
Truncation (suc n) = Nullâˆ™-HigherModality (const _ ğŸ™ (S-âˆ™ {n}))


module Trunc {ğ“¤} n where
  open HigherModality (Truncation {ğ“¤} n)
    public renaming (is-modal to is-truncated)

  private opaque
    AâˆˆS' : âˆ€ {ğ“¤} {A : Type ğ“¤} (n : â„•)
            â†’ HigherModality.is-modal (Truncation n) A
            â†’ is-S-1null n A
    AâˆˆS' zero tr
      =  is-nullâ†is-local (HigherModalityâ†SubU-modal-types (Local-reflective (Î» _ â†’ ! {A = âˆ…}))
                                          (Local-Î£-closed _ (Î» _ â†’ ğŸ™-is-singleton))
                                          _ tr)
    AâˆˆS' {A = A} (suc n) tr
      = HigherModalityâ†SubU-modal-types (Nullâˆ™-reflective (Î» _ â†’ S-âˆ™ {n}))
         Null-Î£-closed A tr


  âˆˆS : âˆ€ {A : Type ğ“¤}
        â†’ is-truncated A
        â†’ is-S-1null n A
  âˆˆS = AâˆˆS' n

Trunc : âˆ€ {ğ“¤} â†’ â„• â†’ Type ğ“¤ â†’ Type ğ“¤
Trunc = Trunc.â—‹_

âˆ¥_âˆ¥ : âˆ€ {ğ“¤} â†’ Type ğ“¤ â†’ Type ğ“¤
âˆ¥_âˆ¥ = Trunc 1
}
%```
}

\subtree[stt-006T]{
\title{Truncation-modal types are #{n}-types}
\taxon{theorem}

\p{We show #{-2} truncated types are singletons, and #{-1} truncated types
are propositions}

%```agda
\agda{
is-singletonâ†is-truncated
  : âˆ€ {ğ“¤} {A : Type ğ“¤}
    â†’ Trunc.is-truncated 0 A
    â†’ is-singleton A
is-singletonâ†is-truncated {A = A} trunc
  = is-singleâ†equiv-to-single (âˆ…-UPâ‰ƒ âˆ™â‰ƒ eqv) ğŸ™-is-singleton where
  orth : A âˆˆ Local-SubU (Î» _ â†’ !) _
  orth = HigherModalityâ†SubU-modal-types
           (Local-reflective {I = ğŸ™} (Î» _ â†’ ! {A = âˆ…}) )
           (Local-Î£-closed ((Î» _ â†’ ! {A = âˆ…})) Î» _ â†’ ğŸ™-is-singleton)
           A trunc

  open is-equiv (Trunc.âˆˆS 0 trunc tt)

  eqv : (âˆ… â†’ A) â‰ƒ A
  eqv = mkâ‰ƒ (const _ _) (Trunc.âˆˆS 0 trunc tt) eâ»Â¹


is-propâ†is-truncated
  : âˆ€ {ğ“¤} {A : Type ğ“¤}
    â†’ Trunc.is-truncated 1 A
    â†’ is-prop A
is-propâ†is-truncated {A = A} tr x y
  =  sym (happly (Îµ f) (Î¹â‚ tt)) âˆ™ happly (Îµ f) (Î¹â‚‚ tt) where
  eqv : is-equiv (Î» a (x : S 0) â†’ a)
  eqv = Trunc.âˆˆS 1 tr tt

  open is-equiv eqv

  f : S 0 â†’ A
  f = rec! (mk-coconeU x y Â¡_)
}
%```
}
