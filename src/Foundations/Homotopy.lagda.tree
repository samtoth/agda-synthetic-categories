\date{2025-02-21}
\title{Homotopies of functions}
\taxon{module}
\meta{module}{\startverb Foundations.Homotopy \stopverb}

\import{stt-macros}

% ```agda
\agda{
module Foundations.Homotopy where

open import Foundations.Functions
open import Foundations.Universes
open import Foundations.Identity
open import Foundations.PathReasoning
}
% ```

\subtree[stt-001M]{
\title{Homotopy}
\meta{defines}{\startverb ["_~_"] \stopverb}

\p{A homotopy between functions is a pointwise equality of functions.}

% ```agda
\agda{
infix 10 _~_
_~_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f g : (a : A) â†’ B a) â†’ Type (ğ“¤ âŠ” ğ“¥)
f ~ g = âˆ€ a â†’ f a ï¼ g a

}
% ```
}

\subtree[stt-001N]{
\taxon{remark}

\meta{defines}{\startverb ["_~âˆ™_", "~refl", "~âˆ™-reflr", "_~â»Â¹", "~âˆ™-sym"] \stopverb}

\p{Homotopies are 2-cells in the #{(\infty, 1)}-category of types and functions. Or equivalently, for every pair of types,
#{X} and #{Y}, we have a #{\infty}-groupoid #{\textrm{Map}(X,Y)} where 0-cells are functions, and 1-cells are homotopies.}

% ```agda
\agda{

infixr 25 _~âˆ™_ 
_~âˆ™_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} 
     â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ {h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ h
(p ~âˆ™ q) a = p a âˆ™ q a


~refl : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f : (a : A) â†’ B a} â†’ f ~ f
~refl a = refl

~âˆ™-reflr : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ ~refl ~ p
~âˆ™-reflr p a = âˆ™-reflr (p a)

infix 20 _~â»Â¹
_~â»Â¹ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ g ~ f 
(p ~â»Â¹) a = sym (p a)

~âˆ™-sym : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ (p ~â»Â¹) ~ ~refl
~âˆ™-sym p a = âˆ™-sym (p a)

}
% ```
}

\subtree[stt-001P]{
\taxon{notation}
\title{reasoning combinators}

\meta{defines}{\startverb ["_~âŸ¨âŸ©", "_~âˆ", "_âŸ©~âˆ™âŸ¨_"] \stopverb}

% ```agda
\agda{
_~âŸ¨âŸ©_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} (f : (a : A) â†’ B a) {g : (a : A) â†’ B a} â†’ f ~ g â†’ f ~ g
x ~âŸ¨âŸ© x~y = x~y
infixr 2 _~âŸ¨âŸ©_

~âŸ¨âŸ©-syntax : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) {g h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ g â†’ f ~ h
~âŸ¨âŸ©-syntax f p q = q ~âˆ™ p

infixr 2 ~âŸ¨âŸ©-syntax
syntax ~âŸ¨âŸ©-syntax x q p = x ~âŸ¨ p âŸ© q

infix  3 _~âˆ
_~âˆ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) â†’ f ~ f
x ~âˆ = ~refl

infixr 25 _âŸ©~âˆ™âŸ¨_
_âŸ©~âˆ™âŸ¨_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} {p q : f ~ g} {h : A â†’ B} â†’ {r : g ~ h} {s : g ~ h}
       â†’ p ~ q â†’ r ~ s â†’ p ~âˆ™ r ~ q ~âˆ™ s
(p âŸ©~âˆ™âŸ¨ q) a = (p a) âŸ©âˆ™âŸ¨ (q a)

}
% ```
}


\subtree[stt-001Q]{
\taxon{definition}
\title{Whiskerings}

\meta{defines}{\startverb ["_â—‚_", "_â–¸_", "_âŸ©~â—‚âŸ¨_"] \stopverb}

\p{We can also define the whiskering of homotopies.}


% ```agda
\agda{
infixr 30 _â—‚_
_â—‚_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
    â†’ (h : âˆ€ {a} â†’ B a â†’ C) {f g : Î  A B} â†’ f ~ g â†’ h âˆ˜ f ~ h âˆ˜ g
(h â—‚ p) x = ap h (p x)


infixl 31 _â–¸_
_â–¸_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
    â†’ {f g : B â†’ C} â†’ f ~ g â†’ (h : A â†’ B) â†’ f âˆ˜ h ~ g âˆ˜ h
(p â–¸ h) x = p (h x)


infixr 28 _âŸ©~â—‚âŸ¨_
_âŸ©~â—‚âŸ¨_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
           (f : B â†’ C) {g h : A â†’ B} {p q : g ~ h} â†’ p ~ q â†’ f â—‚ p ~ f â—‚ q
(f âŸ©~â—‚âŸ¨ p) a = ap (ap f) (p a)

}
% ```

}


\subtree[stt-001O]{
\taxon{remark}
\title{Homotopies are invertible natural transformations}

\meta{defines}{\startverb ["homotopy-natural", "homotopy-inverse"] \stopverb}

\p{If [functions are functors](stt-001F), then homotopies are invertible natural transformations.}

% ```agda
\agda{

homotopy-natural : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} â†’ (h : f ~ g)
                 â†’ âˆ€ {x y} (p : x ï¼ y) â†’ h x âˆ™ ap g p ï¼ ap f p âˆ™ h y  
homotopy-natural _ refl = âˆ™-reflr _

homotopy-inverse : âˆ€ {ğ“¤} {A : Type ğ“¤} (f : A â†’ A) (p : f ~ id) â†’ p â–¸ f ~ f â—‚ p
homotopy-inverse {ğ“¤} {A} f p x = p (f x)                ï¼âŸ¨ âˆ™.insertl A (âˆ™-sym (p x)) âŸ©
                         (p (f x) âˆ™ p x) âˆ™ sym (p x)    ï¼âŸ¨ II x âŸ©
                         (ap f (p x) âˆ™ p x) âˆ™ sym (p x) ï¼âŸ¨ âˆ™.cancell A (âˆ™-sym (p x)) âŸ©
                         ap f (p x) âˆ  where
  I : âˆ€ x â†’ p (f x) âˆ™ p x ï¼ ap f (p x) âˆ™ p x
  I x = ap (p (f x) âˆ™_) (sym (ap-id _)) âˆ™ homotopy-natural p (p x)

  II : âˆ€ x â†’ (p (f x) âˆ™ p x) âˆ™ sym (p x) ï¼ (ap f (p x) âˆ™ p x) âˆ™ sym (p x)
  II x = ap (_âˆ™ sym (p x)) (I x)
}
% ```
}
