\date{2025-02-21}
\title{Homotopies of functions}
\taxon{Module}

\import{stt-macros}

% ```agda
\agda{
module Foundations.Homotopy where

open import Foundations.Functions
open import Foundations.Universes
open import Foundations.Identity
open import Foundations.PathReasoning
}
% ```

\subtree[stt-001M]{
\title{Homotopy}

\p{A homotopy between functions is a pointwise equality of functions.}

% ```agda
\agda{
infix 10 _~_
_~_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f g : (a : A) â†’ B a) â†’ Type (ğ“¤ âŠ” ğ“¥)
f ~ g = âˆ€ a â†’ f a ï¼ g a

}
% ```
}

\subtree[stt-001N]{
\taxon{Remark}

\p{Homotopies are 2-cells in the #{(\infty, 1)}-category of types and functions. Or equivalently, for every pair of types,
#{X} and #{Y}, we have a #{\infty}-groupoid #{\textrm{Map}(X,Y)} where 0-cells are functions, and 1-cells are homotopies.}

% ```agda
\agda{

infixr 25 _~âˆ™_
_~âˆ™_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥}
     â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ {h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ h
(p ~âˆ™ q) a = p a âˆ™ q a


~refl : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f : (a : A) â†’ B a} â†’ f ~ f
~refl a = refl

~âˆ™-reflr : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ ~refl ~ p
~âˆ™-reflr p a = âˆ™-reflr (p a)

infix 20 _~â»Â¹
_~â»Â¹ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ g ~ f
(p ~â»Â¹) a = sym (p a)

~âˆ™-sym : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ (p ~â»Â¹) ~ ~refl
~âˆ™-sym p a = âˆ™-sym (p a)

~âˆ™-sym' : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ (p ~â»Â¹) ~âˆ™ p ~ ~refl
~âˆ™-sym' p a = âˆ™-sym' (p a)

~âˆ™-assoc : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g h k : Î  A B}
           â†’ (H : f ~ g) (K : g ~ h) (L : h ~ k)
           â†’ (H ~âˆ™ K) ~âˆ™ L ~ H ~âˆ™ K ~âˆ™ L
~âˆ™-assoc H K L a = âˆ™-assoc (H a) (K a) (L a)
}
% ```
}

\subtree[stt-001P]{
\taxon{Notation}
\title{Reasoning combinators}


% ```agda
\agda{
_~âŸ¨âŸ©_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} (f : (a : A) â†’ B a) {g : (a : A) â†’ B a} â†’ f ~ g â†’ f ~ g
x ~âŸ¨âŸ© x~y = x~y
infixr 2 _~âŸ¨âŸ©_

~âŸ¨âŸ©-syntax : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) {g h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ g â†’ f ~ h
~âŸ¨âŸ©-syntax f p q = q ~âˆ™ p

infixr 2 ~âŸ¨âŸ©-syntax
syntax ~âŸ¨âŸ©-syntax x q p = x ~âŸ¨ p âŸ© q

infix  3 _~âˆ
_~âˆ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) â†’ f ~ f
x ~âˆ = ~refl

infixr 25 _âŸ©~âˆ™âŸ¨_
_âŸ©~âˆ™âŸ¨_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} {p q : f ~ g} {h : A â†’ B} â†’ {r : g ~ h} {s : g ~ h}
       â†’ p ~ q â†’ r ~ s â†’ p ~âˆ™ r ~ q ~âˆ™ s
(p âŸ©~âˆ™âŸ¨ q) a = (p a) âŸ©âˆ™âŸ¨ (q a)

}
% ```
}


\subtree[stt-001Q]{
\taxon{Definition}
\title{Whiskerings}


\p{We can also define the whiskering of homotopies, as well
as horizontal composition.}


% ```agda
\agda{
infixr 30 _â—‚_
_â—‚_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
    â†’ (h : âˆ€ {a} â†’ B a â†’ C) {f g : Î  A B} â†’ f ~ g â†’ h âˆ˜ f ~ h âˆ˜ g
(h â—‚ p) x = ap h (p x)


infixl 31 _â–¸_
_â–¸_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
    â†’ {f g : B â†’ C} â†’ f ~ g â†’ (h : A â†’ B) â†’ f âˆ˜ h ~ g âˆ˜ h
(p â–¸ h) x = p (h x)


infixr 28 _âŸ©~â—‚âŸ¨_
_âŸ©~â—‚âŸ¨_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
           (f : B â†’ C) {g h : A â†’ B} {p q : g ~ h} â†’ p ~ q â†’ f â—‚ p ~ f â—‚ q
(f âŸ©~â—‚âŸ¨ p) a = ap (ap f) (p a)


â—‚âˆ™ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
       (k : âˆ€ {a} â†’ B a â†’ C) {f g h : Î  A B} (H : f ~ g) (K : g ~ h)
     â†’ k â—‚ (H ~âˆ™ K) ~ (k â—‚ H) ~âˆ™ (k â—‚ K)
â—‚âˆ™ k H K a = ap-âˆ™ k (H a) (K a)

â—‚âˆ™âˆ™ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
       (l : âˆ€ {a} â†’ B a â†’ C) {f g h k : Î  A B}
       (H : f ~ g) (K : g ~ h) (L : h ~ k)
     â†’ l â—‚ (H ~âˆ™ K ~âˆ™ L) ~ (l â—‚ H) ~âˆ™ (l â—‚ K) ~âˆ™ (l â—‚ L)
â—‚âˆ™âˆ™ k H K L a = ap-âˆ™âˆ™ k (H a) (K a) (L a)

â—‚âˆ˜ : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“œ} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
       {D : Type ğ“œ}
       (i : C â†’ D) (h : âˆ€ {a} â†’ B a â†’ C)
       {f g : Î  A B} (H : f ~ g)
     â†’ i âˆ˜ h â—‚ H ~ i â—‚ h â—‚ H
â—‚âˆ˜ i k H a = ap-âˆ˜ i k (H a)

â—‚âˆ˜âˆ˜ : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“œ ğ“›} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
       {D : Type ğ“œ} {E : Type ğ“›}
       (j : D â†’ E) (i : C â†’ D) (h : âˆ€ {a} â†’ B a â†’ C)
       {f g : Î  A B} (H : f ~ g)
     â†’ j âˆ˜ i âˆ˜ h â—‚ H ~ j â—‚ i â—‚ h â—‚ H
â—‚âˆ˜âˆ˜ h i j H a = ap-âˆ˜âˆ˜ h i j (H a)

â—‚â»Â¹ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {C : Type ğ“¦}
        (f : âˆ€ {a} â†’ B a â†’ C) {g h : Î  A B} (H : g ~ h)
      â†’ f â—‚ (H ~â»Â¹) ~ (f â—‚ H ~â»Â¹)
â—‚â»Â¹ f H = ap-sym f âˆ˜ H
}
% ```
}



\subtree[stt-001O]{
\taxon{Remark}
\title{Homotopies are invertible natural transformations}


\p{If [functions are functors](stt-001F), then homotopies are invertible natural transformations.}

% ```agda
\agda{

homotopy-natural : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} â†’ (h : f ~ g)
                 â†’ âˆ€ {x y} (p : x ï¼ y) â†’ h x âˆ™ ap g p ï¼ ap f p âˆ™ h y
homotopy-natural _ refl = âˆ™-reflr _

homotopy-conjugate : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B}
                       (H : f ~ g)
                     â†’ âˆ€ {x y : A} (p : x ï¼ y)
                     â†’ sym (ap f p) âˆ™ H x âˆ™ ap g p ï¼ H y
homotopy-conjugate H refl = âˆ™-reflr _

homotopy-inverse : âˆ€ {ğ“¤} {A : Type ğ“¤} (f : A â†’ A) (p : f ~ id) â†’ p â–¸ f ~ f â—‚ p
homotopy-inverse {ğ“¤} {A} f p x = p (f x)                ï¼âŸ¨ âˆ™.insertl A (âˆ™-sym (p x)) âŸ©
                         (p (f x) âˆ™ p x) âˆ™ sym (p x)    ï¼âŸ¨ II x âŸ©
                         (ap f (p x) âˆ™ p x) âˆ™ sym (p x) ï¼âŸ¨ âˆ™.cancell A (âˆ™-sym (p x)) âŸ©
                         ap f (p x) âˆ  where
  I : âˆ€ x â†’ p (f x) âˆ™ p x ï¼ ap f (p x) âˆ™ p x
  I x = ap (p (f x) âˆ™_) (sym (ap-id _)) âˆ™ homotopy-natural p (p x)

  II : âˆ€ x â†’ (p (f x) âˆ™ p x) âˆ™ sym (p x) ï¼ (ap f (p x) âˆ™ p x) âˆ™ sym (p x)
  II x = ap (_âˆ™ sym (p x)) (I x)

}
% ```
}

\subtree[stt-0094]{
\date{2025-08-14}
\title{Horizontal composition of homotopies}
\taxon{Definition}

\p{We define horizontal composition for homotopies, and show that
it admits an interchange law with respect to vertical composition}

\proof{Follows from [naturality](stt-001O)}

%```agda
\agda{
_~âˆ˜_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
       â†’ {f g : B â†’ C} â†’ f ~ g
       â†’ {h k : A â†’ B} â†’ h ~ k
       â†’ f âˆ˜ h ~ g âˆ˜ k
_~âˆ˜_ {g = g} H {h = h} K = H â–¸ h ~âˆ™ g â—‚ K

infixr 28 _âŸ©~âˆ˜âŸ¨_
_âŸ©~âˆ˜âŸ¨_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
       â†’ {f g : B â†’ C} {H H' : f ~ g} â†’ H ~ H'
       â†’ {h k : A â†’ B} {K K' : h ~ k} â†’ K ~ K'
       â†’ H ~âˆ˜ K ~ H' ~âˆ˜ K'
(P âŸ©~âˆ˜âŸ¨ Q) a = apâ‚‚ _âˆ™_ (P _) (ap (ap _) (Q a))

_~âˆ˜'_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
        â†’ {f g : B â†’ C} â†’ f ~ g
        â†’ {h k : A â†’ B} â†’ h ~ k
        â†’ f âˆ˜ h ~ g âˆ˜ k
_~âˆ˜'_ {f = f} H {k = k} K = f â—‚ K ~âˆ™ H â–¸ k

switch-~âˆ˜ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
            â†’ {f g : B â†’ C} (H : f ~ g)
            â†’ {h k : A â†’ B} (K : h ~ k)
            â†’ H ~âˆ˜ K ~ H ~âˆ˜' K
switch-~âˆ˜ H K a = homotopy-natural H (K a)

homotopy-interchange
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
      {f g h : B â†’ C} (H : f ~ g) (L : g ~ h)
      {k l m : A â†’ B} (K : k ~ l) (J : l ~ m)
    â†’ (H ~âˆ˜ K) ~âˆ™ (L ~âˆ˜ J) ~ (H ~âˆ™ L ~âˆ˜ K ~âˆ™ J)
homotopy-interchange {f = f}{g}{h} H L {k}{l}{m} K J
  = (H ~âˆ˜ K) ~âˆ™ (L ~âˆ˜ J) ~âŸ¨âŸ©
    (H â–¸ k ~âˆ™ g â—‚ K) ~âˆ™ L â–¸ l ~âˆ™ h â—‚ J   ~âŸ¨ ~âˆ™-assoc _ (L â–¸ l) (h â—‚ J) ~â»Â¹ âŸ©
    ((H â–¸ k ~âˆ™ g â—‚ K) ~âˆ™ L â–¸ l) ~âˆ™ h â—‚ J ~âŸ¨ ~âˆ™-assoc _ (g â—‚ K) (L â–¸ l) âŸ©~âˆ™âŸ¨ ~refl {f = h â—‚ J}  âŸ©
    (H â–¸ k ~âˆ™ (g â—‚ K ~âˆ™ L â–¸ l)) ~âˆ™ h â—‚ J ~âŸ¨ ~âˆ™-assoc (H â–¸ k) _ (h â—‚ J)  âŸ©
    H â–¸ k ~âˆ™ (g â—‚ K ~âˆ™ L â–¸ l) ~âˆ™ h â—‚ J

        ~âŸ¨ ~refl {f = H â–¸ k} âŸ©~âˆ™âŸ¨ sym âˆ˜ homotopy-natural L âˆ˜ K âŸ©~âˆ™âŸ¨ ~refl {f = h â—‚ J} âŸ©

    H â–¸ k ~âˆ™ (L â–¸ k ~âˆ™ h â—‚ K) ~âˆ™ h â—‚ J ~âŸ¨ ~refl {f = H â–¸ k} âŸ©~âˆ™âŸ¨ ~âˆ™-assoc (L â–¸ k) (h â—‚ K) (h â—‚ J)  âŸ©
    H â–¸ k ~âˆ™ L â–¸ k ~âˆ™ (h â—‚ K ~âˆ™ h â—‚ J) ~âŸ¨ ~refl {f = H â–¸ k} âŸ©~âˆ™âŸ¨ ~refl {f = L â–¸ k} âŸ©~âˆ™âŸ¨ ( â—‚âˆ™ h K J ~â»Â¹ )    âŸ©
    H â–¸ k ~âˆ™ L â–¸ k ~âˆ™ h â—‚ (K ~âˆ™ J)     ~âŸ¨ ~âˆ™-assoc (H â–¸ k) (L â–¸ k) _ ~â»Â¹ âŸ©
    (H â–¸ k ~âˆ™ L â–¸ k) ~âˆ™ h â—‚ (K ~âˆ™ J)   ~âŸ¨âŸ©
    (H ~âˆ™ L) ~âˆ˜ (K ~âˆ™ J) ~âˆ
}
%```
}
