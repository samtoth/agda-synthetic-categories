\date{2025-02-20}
\title{Function types}

\import{stt-macros}

% ```agda
\agda{
module foundations.Functions where

open import foundations.universe
open import foundations.Sigma
open import foundations.Identity
open import foundations.Singleton
}
% ```

\subtree{
\taxon{definition}
\title{Fibres}
\p{Given a function #{f : A \to B}, we define the fibre of #{f} at #{b : B}, notated #{\fibre{f}{a}} to be the type
#{\Sigma_{a : A}{f(a) = b}}. }

\p{Note that this is subtly different to the preimage, as we can show that #{\Sigma_{(b : B)} \fibre{f}{b}} is equivalent to #{A} itself.}

% ```agda
\agda{

fibre : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} (f : A â†’ B) â†’ B â†’ Type (ğ“¤ âŠ” ğ“¥)
fibre f b = Î£ _ Î» a â†’ f a ï¼ b


total-fibre : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} (f : A â†’ B) â†’ Type (ğ“¤ âŠ” ğ“¥)
total-fibre f = Î£ _ (fibre f)

total-fibreâ†’dom : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f : A â†’ B} â†’ total-fibre f â†’ A
total-fibreâ†’dom (._ , a , refl) = a

domâ†’total-fibre : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f : A â†’ B} â†’ A â†’ total-fibre f
domâ†’total-fibre {f = f} a = f a , a , refl

test'' : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f : A â†’ B} â†’ âˆ€ (x : total-fibre f) â†’ domâ†’total-fibre (total-fibreâ†’dom x) ï¼ x  
test'' (._ , a , refl) = refl

test''' :  âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f : A â†’ B} â†’ âˆ€ (x : A) â†’ total-fibreâ†’dom (domâ†’total-fibre {f = f} x) ï¼ x  
test''' a = refl

}
% ```
}

\p{The fibre type gives us a useful tool for talking about properties of maps. Generally if we have a property of types for example being #{n}-connected, we reuse the same terminology on maps to mean all fibres of the map have the corresponding property.}


\subtree{
\taxon{definition}
\title{embeddings}

\p{We call a map an embedding if the fibres are all sub-singletons. This notion is a generalisation of injective set functions, infact if we - for a moment - imagine fibre to mean preimage, then a function of sets is injecte if each preimage is either empty or has a unique inhabitant.}

% ```agda
\agda{
is-embedding : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} (f : A â†’ B) â†’ Type (ğ“¤ âŠ” ğ“¥)
is-embedding f = âˆ€ b â†’ is-subsingleton (fibre f b)
}
% ```
}


\subtree{
\taxon{definition}
\title{equivalence}

\p{A map is said to be an equivalence if each of its fibres is a singleton.}

\agda{
is-equiv : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} (f : A â†’ B) â†’ Type (ğ“¤ âŠ” ğ“¥)
is-equiv f = âˆ€ b â†’ is-singleton (fibre f b)
}
% ```
}
