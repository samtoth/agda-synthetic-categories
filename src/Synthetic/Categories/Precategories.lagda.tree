\date{2025-11-17}
\title{Precategories}
\author{samueltoth}
\taxon{Module}
\import{stt-macros}

\transclude{stt-00AB}

%```agda
\agda{
open import Foundations.Prelude
open import Algebra.Lattice

module Synthetic.Categories.Precategories
  {ğ“˜} (Î”Â¹ : Type ğ“˜) (I : Lattice Î”Â¹) (I-distr : is-distributive I)
  where

open import ufAxioms

open Lattice I renaming (0l to i0; 1l to i1)
import Algebra.Lattice.Instances.Polynomial as Poly
open Poly  hiding (L[x]; Î”Â²)
open is-distributive I-distr

private
  Î”Â² = Poly.Î”Â² I
  I[x] = Poly.L[x] I I-distr

open import Modalities.Subuniverses
open import Modalities.GlobalSubuniverses
open import Modalities.Instances.Localisation
open import Modalities.Instances.Truncation
open import Modalities.ModalMaps

open import Core.Join
open import Core.CanonicalPushouts

open import Synthetic.Categories.Simplicial Î”Â¹ I I-distr
open import Synthetic.Categories.Horns Î”Â¹ I I-distr
open import Synthetic.Hom Î”Â¹ i0 i1
}
%```


\subtree[stt-00AI]{
\title{Precategories}
\taxon{Definition}


\p{We say that a type is a \strong{precategory} or that it is a \strong{Segal}
type if it is local with respect to the inclusion of the [#{(2,1)} horn](stt-00AD)
into the 2-simplex. We can use the fact that [being local with respect to some
class of maps forms a global reflective subuniverse](stt-0066) to bootstrap some
useful notions, such as preservation under identity and pi types as well as the
localisation operation. Note that unlike in the case of [simplicial types](stt-00AC)
this subuniverse is neither #{\Sigma}-closed nor lex.}

\p{We call maps which are local to the inner horn inclusion \strong{inner maps}.}

%```agda
\agda{
open Subtype

is-precategory : âˆ€ {ğ“¤} (C : Type ğ“¤) â†’ Type (ğ“¤ âŠ” ğ“˜)
is-precategory = is-local Î» (tt : ğŸ™) â†’ Î›[2,1]-incl

Precats-SubU : âˆ€ {ğ“¤} â†’ SubU ğ“¤ (ğ“¤ âŠ” ğ“˜)
Precats-SubU = Local-SubU (Î» (tt : ğŸ™) â†’ Î›[2,1]-incl) _

Precats-GSU : GSU (_âŠ” ğ“˜)
Precats-GSU = Local-GSU (Î» (tt : ğŸ™) â†’ Î›[2,1]-incl)

Precats-is-globally-reflective
   : is-globally-reflective Precats-GSU
Precats-is-globally-reflective
  = Local-global-reflectors (Î» (tt : ğŸ™) â†’ Î›[2,1]-incl)

module Precat where
  open GSU Precats-GSU public renaming (S-equiv to is-precategoryâ†equiv)

  open is-globally-reflective Precats-is-globally-reflective

  is-inner : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} â†’ (A â†’ B) â†’ Type (ğ“˜ âŠ” ğ“¤ âŠ” ğ“¥)
  is-inner = is-modal-map Precats-SubU
}
%```
}

\subtree[stt-00AK]{
\title{Composite morphisms}
\taxon{Definition}

\p{Given the data of the boundary of a 2-simplex:}

\quiver{
\begin{tikzcd}
        x && y \\
	\\
	&& z
	\arrow["g", from=1-1, to=1-3]
	\arrow["h"', from=1-1, to=3-3]
	\arrow["f", from=1-3, to=3-3]
\end{tikzcd}
}

\p{We define the type of fillers, written #{\Hom 2(f,g;h)}, which we say witnesses
that #{fg \sim h}.}

%```agda
\agda{
Hom2 : âˆ€ {ğ“¤} {A : Type ğ“¤} {x y z : A}
         (f : Hom _ y z) (g : Hom _ x y) (h : Hom _ x z)
       â†’ Type (ğ“˜ âŠ” ğ“¤)
Hom2 {A = A} f g h
  = Î£[ H âˆ¶ (Î”Â² â†’ A) ] (
      (âˆ€ i â†’ H (i , i0) ï¼ g .HomP.hom i)
    Ã— (âˆ€ i â†’ H (i1 , i) ï¼ f .HomP.hom i)
    Ã— (âˆ€ i â†’ H (i , i)  ï¼ h .HomP.hom i))
}
%```
}


\subtree[stt-00AL]{
\title{Morphisms have unique composites in a precategory}
\taxon{Theorem}

\p{Given a pair of composable morphisms, we can naturally define a map
#{\Delta^2_1 \to C}. We show that there is a unique 2-simplex that extends
#{f} and #{g}.}


\proof{
\p{[Precategories](stt-00AI) are defined to be those types which are local
with respect to the inclusion #{i : \Lambda^2_1 \hookrightarrow \Delta^2}. The
fibres of #{i^* : (\Delta^2 \to C) \to (\Lambda^2_1 \to C)} are exactly the maps
#{\Delta^2 \to C} which extend the boundary #{f,g}.}
}

%```agda
\agda{
precategory-unique-composite : âˆ€ {ğ“¤} {A : Type ğ“¤} {x y z} â†’ is-precategory A
                             â†’ (f : Hom A y z) (g : Hom A x y)
                             â†’ is-singleton (Î£[ H âˆ¶ (Î”Â² â†’ A)]
                                               (H âˆ˜ Î›[2,1]-incl ï¼ make-horn f g))
precategory-unique-composite Apc f g
  = is-contr-mapâ†is-equiv (Apc tt) (make-horn f g)

compositeâ†horn-extension
  : âˆ€ {ğ“¤} {A : Type ğ“¤} {x y z} (f : Hom A y z) (g : Hom A x y)
    â†’ Î£[ H âˆ¶ (Î”Â² â†’ A)] (H âˆ˜ Î›[2,1]-incl ï¼ make-horn f g)
    â†’ Î£[ h âˆ¶ Hom A x z ] (Hom2 f g h)
compositeâ†horn-extension f g (H , extends)
  = (mk-hom (H âˆ˜ Î”Â²-diagonal)
            (ap H Î”Â²-refl âˆ™ happly extends (Î¹â‚ i0) âˆ™ g .HomP.hom0)
            (ap H Î”Â²-refl âˆ™ happly extends (Î¹â‚‚ i1) âˆ™ f .HomP.hom1)
    , (H , happly extends âˆ˜ Î¹â‚ , happly extends âˆ˜ Î¹â‚‚ , ~refl)
    )

_âŠ™[_]_ :  âˆ€ {ğ“¤} {A : Type ğ“¤} {x y z} â†’ Hom A y z â†’ is-precategory A
          â†’ Hom A x y â†’ Hom A x z
f âŠ™[ apc ] g = fst (compositeâ†horn-extension f g
                    (centre (precategory-unique-composite apc f g)))

}
%```
}
