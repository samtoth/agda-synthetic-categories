\date{2025-06-17}
\title{The Free Algabraicly Injective HIT}
\taxon{module}
\meta{module}{\startverb axioms.FreeAlgInj \stopverb}
\author{samueltoth}
\import{stt-macros}

%```agda
\agda{
{-#Â OPTIONS --allow-unsolved-metas #-}
module axioms.FreeAlgInj where

open import ufAxioms
open import foundations.Prelude
open import core.Arrow
open import core.Lifts
open import core.PullbackPower
}
%```

\subtree[stt-0060]{
\taxon{remark}

\p{The condition of [orthogonality](stt-0048) says that lifting
problems as above have unique solutions. Algabraic injectivity
is a weakening of this to only require that a chosen solution.}
}

\subtree[stt-005L]{
\taxon{definition}
\title{Weak orthogonators of maps}

\p{[Orthogonal maps](stt-004A) require uniqueness of
lifting solution. When this uniqueness requirement is lifted
we can speak of the type of weak-orthogonators for a pair of
maps, which give a chosen lift for each lifting problem.
When this type is merely inhabited we say that a pair of maps
are weakly orthogonal.}

%```agda
\agda{
weak-orthogonator : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“›} {A : Type ğ“¤} {B : Type ğ“¥}
                          {C : Type ğ“¦} {D : Type ğ“›}
                        â†’ (f : A â†’ B)
                        â†’ (g : C â†’ D)
                        â†’ Type (ğ“¤ âŠ” ğ“¥ âŠ” ğ“¦ âŠ” ğ“›)
weak-orthogonator f g = âˆ€ (H : Arrow-map f g) â†’ Lift H
}
%```
}


\subtree[stt-005N]{
\taxon{theorem}
\title{Weakly orthogonal maps give a section of the pullback power}

\p{A map #{f} is weakly orthogonal to #{g} iff the [pullback power](stt-004D)
 #{f \pitchfork g} has a section.}

%```agda
\agda{
sec-pb-powerâ†weak-orthogonator
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“›} {A : Type ğ“¤} {B : Type ğ“¥}
      {C : Type ğ“¦} {D : Type ğ“›}
      {f : A â†’ B} {g : C â†’ D}
    â†’ weak-orthogonator f g
    â†’ section (pullback-power f g)
sec-pb-powerâ†weak-orthogonator {f = f} {g} lift
  = sectionâ†fibres _ fib where
  fib : âˆ€ (H : Arrow-map f g) â†’ fibre (pullback-power f g) H
  fib H =  _â‰ƒ_.bwd (pb-power-fibreâ‰ƒlifts _ _ _) (lift H)

sec-pb-powerâ‰ƒweak-orthogonator
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“›} {A : Type ğ“¤} {B : Type ğ“¥}
      {C : Type ğ“¦} {D : Type ğ“›}
      {f : A â†’ B} {g : C â†’ D}
    â†’ weak-orthogonator f g
    â‰ƒ section (pullback-power f g)
sec-pb-powerâ‰ƒweak-orthogonator {f = f}{g}
  = Î  (Arrow-map f g) Lift
      â‰ƒâŸ¨ precomp-Î -â‰ƒ (Î» c â†’ pb-power-fibreâ‰ƒlifts _ _ c eâ»Â¹) âŸ©
    Î  (Arrow-map f g) (fibre (pullback-power f g))
      â‰ƒâŸ¨ sectionâ‰ƒfibres _ âŸ©
    section (pullback-power f g) â‰ƒâˆ
}
%```
}

\subtree[stt-005O]{
\title{Weak orthogonators for types}
\taxon{definition}

\p{A weak orthogonator for a type mirrors the definitions
for the stronger notion of [orthogonality at types](stt-004O).
We require not that the precomposition by #{f} is an equivalence,
but instead talk about the \em{type} of sections to postcomposition by #{f}.
}

\p{A weak orthogonator for type #{X} with respect to a map #{f : A \to B}
is a section of #{X^f : (B \to X) \to (A \to X)}.}

%```agda
\agda{
weak-type-orthogonator
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
      (f : A â†’ B) (X : Type ğ“¦)
    â†’ Type (ğ“¤ âŠ” ğ“¥ âŠ” ğ“¦)
weak-type-orthogonator f X = section (postcomp X f)
}
%```
}

\subtree[stt-005P]{
\taxon{theorem}

\p{Mirroring the [corresponding theorem](stt-004Q) for orthogonality,
we can say that the type of weak type orthogonators for #{X} against #{f}
is equivalent to the type of weak orthoginators for the map #{! : A \to 1}
against #{f}.}


%```agda
\agda{
weak-type-orthogonator-!
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
      {f : A â†’ B} {X : Type ğ“¦}
    â†’ weak-type-orthogonator f X
    â‰ƒ weak-orthogonator f (! {A = X})
weak-type-orthogonator-! = {!!}
}
%```
}


\subtree[stt-005J]{
\taxon{definition}
\title{Algabraicly injective types}

\p{Given a family of maps #{f_i : A_i \to B_i}, we say that a type
#{X} is \em{algabraicly} #{f\rm{-injective}} if for any family of maps
#{a_i : A_i \to X}, there is a chosen extension of #{a} along #{f_i}, that
is, the following diagram commutes for all #{i}: }

\quiver{
\begin{tikzcd}
	{A_i} && X \\
	\\
	{B_i}
	\arrow["{a_i}", from=1-1, to=1-3]
	\arrow["{f_i}"', from=1-1, to=3-1]
	\arrow[dashed, from=3-1, to=1-3]
\end{tikzcd}
}

\p{We observe that this definition is equivalent to asking for
a chosen [weak orthogonator](stt-005O) for #{X} against each #{f_i}.}

%```agda
\agda{
algabraic-injector
  : âˆ€ {ğ“˜ ğ“¤ ğ“¥ ğ“¦} {I : Type ğ“˜}
      {A : I â†’ Type ğ“¤} {B : I â†’ Type ğ“¥}
      (f : (i : I) â†’ A i â†’ B i)
      (X : Type ğ“¦)
     â†’ Type (ğ“˜ âŠ” ğ“¤ âŠ” ğ“¥ âŠ” ğ“¦)
algabraic-injector f X = âˆ€ i â†’ weak-type-orthogonator (f i) X
}
%```
}

\subtree[stt-005I]{
\taxon{definition}
\title{Free algabraicly-injective types}
\citek{rijkeMod2020}

\p{Given a family of types #{f_i : A_i \to B_i} and a type #{X}, we can
define the free algabraicly #{f\rm{-injective}} type on #{X}, called
#{\mathcal{J}_{f}(X)} with the following
higher inductive type:}

\ul{
\li{#{\eta : X \to \mathcal{J}_{f}(X)}}
\li{#{\rm{ext}_i : (A_i \to \mathcal{J}_{f}(X)) \to (B_i \to \mathcal{J}_{f}(X))}}
\li{#{\rm{isext}_i : \Pi_{(g : A_i \to \mathcal{J}_{f}(X))} \Pi_{(a : A_i)}
                     \rm{ext}_i(g,f(a)) = g(a)}}
}

\p{In plain agda we have to define higher inductive types via
postulates.}

%```agda
\agda{
module _ {ğ“˜ ğ“¤ ğ“¥ ğ“¦} {I : Type ğ“˜} {A : I â†’ Type ğ“¤}
         {B : I â†’ Type ğ“¥} where
  postulate
    Free-inj : (f : âˆ€ i â†’ A i â†’ B i) â†’ Type ğ“¦ â†’ Type ğ“¦

  module Free-inj {f : âˆ€ i â†’ A i â†’ B i} {X : Type ğ“¦} where
    postulate
      inc   : X â†’ Free-inj f X
      ext : âˆ€ {i} â†’ (g : A i â†’ Free-inj f X)
                       â†’ B i â†’ Free-inj f X
      is-ext : âˆ€ {i} â†’ (g : A i â†’ Free-inj f X)
                          (a : A i) â†’ ext g (f i a) ï¼ g a

      ind : âˆ€ {ğ“œ} (P : Free-inj f X â†’ Type ğ“œ)
              (N : (x : X) â†’ P (inc x))
              (R : âˆ€ {i} (g : A i â†’ Free-inj f X)
                   â†’ ((a : A i) â†’ P (g a))
                   â†’ âˆ€ (b : B i) â†’ P (ext g b))
              (S : âˆ€ {i} (g : A i â†’ Free-inj f X)
                    (h : (a : A i) â†’ P (g a))
                    (a : A i)
                   â†’ tr P (is-ext g a) (R g h (f i a)) ï¼ h a)
            â†’ (x : Free-inj f X) â†’ P x

      ind-inc : âˆ€ {ğ“œ} {P : Free-inj f X â†’ Type ğ“œ}
                  {N : (x : X) â†’ P (inc x)}
                  {R : âˆ€ {i} (g : A i â†’ Free-inj f X)
                       â†’ ((a : A i) â†’ P (g a))
                       â†’ âˆ€ (b : B i) â†’ P (ext g b)}
                  {S : âˆ€ {i} (g : A i â†’ Free-inj f X)
                         (h : (a : A i) â†’ P (g a))
                         (a : A i)
                       â†’ tr P (is-ext g a) (R g h (f i a)) ï¼ h a}
                 â†’ âˆ€ x â†’ ind P N R S (inc x) ï¼ N x

      ind-ext : âˆ€ {ğ“œ} {P : Free-inj f X â†’ Type ğ“œ}
                  {N : (x : X) â†’ P (inc x)}
                  {R : âˆ€ {i} (g : A i â†’ Free-inj f X)
                       â†’ ((a : A i) â†’ P (g a))
                       â†’ âˆ€ (b : B i) â†’ P (ext g b)}
                  {S : âˆ€ {i} (g : A i â†’ Free-inj f X)
                         (h : (a : A i) â†’ P (g a))
                         (a : A i)
                       â†’ tr P (is-ext g a) (R g h (f i a)) ï¼ h a}
                 â†’ âˆ€ {i} (g : A i â†’ Free-inj f X)
                     (h : (a : A i) â†’ P (g a))
                   â†’ (b : B i) â†’ ind P N R S (ext g b) ï¼ R g h b

      -- TODO: Formulate path beta rule for is-ext
      -- ind-is-ext : âˆ€ {ğ“œ} {P : Free-inj f X â†’ Type ğ“œ}
      --             {N : (x : X) â†’ P (inc x)}
      --             {R : âˆ€ {i} (g : A i â†’ Free-inj f X)
      --                  â†’ ((a : A i) â†’ P (g a))
      --                  â†’ âˆ€ (b : B i) â†’ P (ext g b)}
      --             {S : âˆ€ {i} (g : A i â†’ Free-inj f X)
      --                    (h : (a : A i) â†’ P (g a))
      --                    (a : A i)
      --                  â†’ tr P (is-ext g a) (R g h (f i a)) ï¼ h a}
      --            â†’ âˆ€ {i} (g : A i â†’ Free-inj f X)

    {-# REWRITE ind-inc #-}
}
%```
}

\subtree[stt-005W]{
\date{2025-06-18}
\title{Free algabraicly-injective types are algabraicly-injective}
\taxon{theorem}

%```agda
\agda{
module _ {ğ“˜ ğ“¤ ğ“¥ ğ“¦} {I : Type ğ“˜} {A : I â†’ Type ğ“¤}
         {B : I â†’ Type ğ“¥} where
  injector-Free-inj
    : âˆ€ {f : (i : I) â†’ A i â†’ B i}
        {X : Type ğ“¦}
      â†’ algabraic-injector f (Free-inj f X)
  injector-Free-inj i .fst = Free-inj.ext
  injector-Free-inj i .snd Î±
    = funextâ†’ (Free-inj.is-ext Î±)
}
%```
}
