\title{Polynomials over distributive lattices}
\taxon{Module}
\author{samueltoth}
\date{2025-10-24}
\import{stt-macros}

%```agda
\agda{
module Algebra.Lattice.Instances.Polynomial where

open import Foundations.Prelude
open import ufAxioms

open import Algebra.Lattice
open import Algebra.Poset
open import Modalities.Instances.Truncation

open import Ergonomics.Marker
open import Ergonomics.Auto
open import Ergonomics.Representation

open import Core.CoSlice
open import Data.Bool

}
%```

\subtree[stt-00A5]{
\title{Idea}

\p{We use our intuition for rings to define the free algebras of distributive
lattices as the polynomials. For a first approximation then, we  write a polynomial
as a sequence of terms (where #{x^n} is the n-fold join of x):}

##{
a_n \land x^n \lor a_{n-1}\land x^{n-1} \lor ... \lor a_0
}

\p{In this setting we have idempotence of meet and join, so all terms #{a_n x^n} with
#{n>2} reduce to #{a_n \land x}.}

\p{Finally, we note that for any #{x,a,b} in the lattice,
##{a \land x \lor b = (a \lor b) \land x \lor b}. With these two observation,
we can now see that polynomials in one variable (#{x}) can be represented
uniquely as #{a \land x \lor b} with #{a \ge b}. }
}

\subtree[stt-009X]{
\taxon{Definition}
\title{The 2-simplex}

\p{We give a geometrically-suggestive name to the underlying set of the [free
distributive lattice algebra](stt-009W)}

%```agda
\agda{

record Œî¬≤ {ùì§} {A : Type ùì§} (L : Lattice A) : Type ùì§ where
  constructor _,_
  open Lattice L
  field
    s t : A
    ‚¶É mono ‚¶Ñ : t ‚â§ s

module _ {ùì§} {A : Type ùì§} {L : Lattice A} where
  open Lattice L

  unquoteDecl Œî¬≤-repr‚âÖ Œî¬≤-repr‚âÉ = make-record-repr Œî¬≤-repr‚âÖ Œî¬≤-repr‚âÉ (quote Œî¬≤)

  Œî‚ÇÅ-is-set : is-truncated 2 (Œî¬≤ L)
  Œî‚ÇÅ-is-set = Trunc.is-truncated‚Üêequiv (Œî¬≤-repr‚âÉ e‚Åª¬π)
                 (Trunc.Œ£-is-truncated
                   car-is-set
                   Œª a ‚Üí Trunc.Œ£-is-truncated
                          car-is-set
                            Œª b ‚Üí suc-is-truncated _ (car-is-set _ _))

  Œî‚ÇÅ-ext : ‚àÄ {a b : Œî¬≤ L} ‚Üí ((a .Œî¬≤.s Ôºù b .Œî¬≤.s) √ó (a .Œî¬≤.t Ôºù b .Œî¬≤.t)) ‚Üí a Ôºù b
  Œî‚ÇÅ-ext {x@((a , b) ‚¶É m ‚¶Ñ)} {y@(a , b)} (refl , refl)
    = unap-equiv (Œî¬≤-repr‚âÉ ._‚âÉ_.has-is-eqv)
       (Œ£-path‚Üí (refl
                , (Œ£-path‚Üí (refl
                , (((unlift (car-is-set _ _ _ _)) .centre))))))

  Œî‚ÇÅ-ext-is-equiv : ‚àÄ {a b : Œî¬≤ L} ‚Üí is-equiv (Œî‚ÇÅ-ext {a} {b})
  Œî‚ÇÅ-ext-is-equiv = is-equiv‚Üêinverse
                      (is-prop-Œ£ (is-set-separated _ _) Œª _ ‚Üí is-set-separated _ _)
                      (is-prop‚Üêis-truncated (Œî‚ÇÅ-is-set _ _))
                      Œª where refl ‚Üí (refl , refl)
}
%```
}


\subtree[stt-009W]{
\title{The algbera of polynomials over a distributive lattice}
\taxon{Definition}

\p{We now construct the free [distributive](stt-00A4) [lattice](stt-009T)
[algebra](stt-009Z)}


%```agda
\agda{
module _ {ùì§} {A : Type ùì§} (L : Lattice A) (distr : is-distributive L) where
  open Lattice L
  open is-distributive distr

  L[x] : Lattice (Œî¬≤ L) -- a ‚àß x ‚à® b ‚àà L[x]
  L[x] .Lattice.0l = (0l , 0l)
  L[x] .Lattice.1l = (1l , 1l)
  L[x] .Lattice._‚à®_ (a‚ÇÄ , a‚ÇÅ) (b‚ÇÄ , b‚ÇÅ)
    = (a‚ÇÄ ‚à® b‚ÇÄ , a‚ÇÅ ‚à® b‚ÇÅ)
  L[x] .Lattice._‚àß_ (a‚ÇÄ , a‚ÇÅ) (b‚ÇÄ , b‚ÇÅ)
    = ((a‚ÇÄ ‚àß b‚ÇÅ) ‚à® (a‚ÇÅ ‚àß b‚ÇÄ) ‚à® (a‚ÇÄ ‚àß b‚ÇÄ), a‚ÇÅ ‚àß b‚ÇÅ) ‚¶É ‚à®-‚â§-introl auto! ‚¶Ñ
  L[x] .Lattice.str-is-lattice = l where
    opaque
      lemma1 : ‚àÄ {a‚ÇÄ a‚ÇÅ : A} ‚¶É p : a‚ÇÅ ‚â§ a‚ÇÄ ‚¶Ñ ‚Üí
               (a‚ÇÄ ‚àß 1l) ‚à®
               (a‚ÇÅ ‚àß 1l) ‚à® (a‚ÇÄ ‚àß 1l)
               Ôºù a‚ÇÄ
      lemma1 {a‚ÇÄ} {a‚ÇÅ}
        = ((a‚ÇÄ ‚àß 1l) ‚à® (a‚ÇÅ ‚àß 1l) ‚à® (a‚ÇÄ ‚àß 1l))
            Ôºù‚ü® ap‚ÇÇ _‚à®_ 1-top (ap‚ÇÇ _‚à®_ 1-top 1-top) ‚ü©
          a‚ÇÄ ‚à® a‚ÇÅ ‚à® a‚ÇÄ
            Ôºù‚ü® ‚à®-assoc ‚àô ‚à®-comm ‚àô ‚à®-assoc ‚àô ap (_‚à® a‚ÇÅ) ‚à®-idem ‚ü©
          a‚ÇÄ ‚à® a‚ÇÅ
            Ôºù‚ü® ‚à®-comm ‚àô ‚â§-max auto! ‚ü©
          a‚ÇÄ ‚àé

      lemma2 : ‚àÄ {a‚ÇÄ a‚ÇÅ b‚ÇÄ b‚ÇÅ} ‚¶É p : a‚ÇÄ ‚â§ a‚ÇÅ ‚¶Ñ ‚¶É q : b‚ÇÄ ‚â§ b‚ÇÅ ‚¶Ñ
               ‚Üí a‚ÇÅ ‚à® (a‚ÇÅ ‚àß b‚ÇÄ) ‚à® (a‚ÇÄ ‚àß b‚ÇÅ) ‚à® (a‚ÇÅ ‚àß b‚ÇÅ) Ôºù a‚ÇÅ
      lemma2 {a‚ÇÄ} {a‚ÇÅ} {b‚ÇÄ} {b‚ÇÅ} ‚¶É p ‚¶Ñ
        = (a‚ÇÅ ‚à® a‚ÇÅ ‚àß b‚ÇÄ ‚à® a‚ÇÄ ‚àß b‚ÇÅ ‚à® a‚ÇÅ ‚àß b‚ÇÅ) Ôºù‚ü® ‚à®-assoc ‚àô ap‚ÇÇ _‚à®_ ‚à®-‚àß-abs refl ‚ü©
          (a‚ÇÅ ‚à® a‚ÇÄ ‚àß b‚ÇÅ ‚à® a‚ÇÅ ‚àß b‚ÇÅ)           Ôºù‚ü® ‚à®-assoc ‚àô ‚à®-comm ‚àô ‚à®-assoc
                                               ‚àô ap‚ÇÇ _‚à®_ (‚à®-comm ‚àô ‚à®-‚àß-abs) refl ‚ü©
          (a‚ÇÅ ‚à® a‚ÇÄ ‚àß b‚ÇÅ)                     Ôºù‚ü® distrib-‚à®-‚àß ‚ü©
          ((a‚ÇÅ ‚à® a‚ÇÄ) ‚àß (a‚ÇÅ ‚à® b‚ÇÅ))            Ôºù‚ü® ap (_‚àß (a‚ÇÅ ‚à® b‚ÇÅ))
                                                    (‚à®-comm ‚àô ‚â§-max p) ‚ü©
          a‚ÇÅ ‚àß (a‚ÇÅ ‚à® b‚ÇÅ)                     Ôºù‚ü® ‚àß-‚à®-abs ‚ü©
          a‚ÇÅ    ‚àé

      lemma3 : ‚àÄ {a‚ÇÄ a‚ÇÅ b‚ÇÄ b‚ÇÅ} ‚¶É m : a‚ÇÄ ‚â§ a‚ÇÅ ‚¶Ñ ‚¶É n : b‚ÇÄ ‚â§ b‚ÇÅ ‚¶Ñ
               ‚Üí a‚ÇÅ ‚àß (a‚ÇÄ ‚à® b‚ÇÄ) ‚à® a‚ÇÄ ‚àß (a‚ÇÅ ‚à® b‚ÇÅ) ‚à® a‚ÇÅ ‚àß (a‚ÇÅ ‚à® b‚ÇÅ) Ôºù a‚ÇÅ
      lemma3 {a‚ÇÄ} {a‚ÇÅ} {b‚ÇÄ} {b‚ÇÅ} ‚¶É m ‚¶Ñ ‚¶É n ‚¶Ñ
        = (a‚ÇÅ ‚àß (a‚ÇÄ ‚à® b‚ÇÄ) ‚à® a‚ÇÄ ‚àß (a‚ÇÅ ‚à® b‚ÇÅ) ‚à® a‚ÇÅ ‚àß (a‚ÇÅ ‚à® b‚ÇÅ))
            Ôºù‚ü® ap‚ÇÇ _‚à®_ refl (ap‚ÇÇ _‚à®_ (‚à®-‚â§-introl m) ‚àß-‚à®-abs) ‚ü©
          ((a‚ÇÅ ‚àß (a‚ÇÄ ‚à® b‚ÇÄ)) ‚à® a‚ÇÄ ‚à® a‚ÇÅ)
            Ôºù‚ü® ap‚ÇÇ _‚à®_ distrib-‚àß-‚à® (‚â§-max m) ‚ü©
          ((a‚ÇÅ ‚àß a‚ÇÄ ‚à® a‚ÇÅ ‚àß b‚ÇÄ) ‚à® a‚ÇÅ)
            Ôºù‚ü® sym ‚à®-assoc ‚àô ap (_ ‚à®_) (‚à®-comm ‚àô ‚à®-‚àß-abs) ‚ü©
          (a‚ÇÅ ‚àß a‚ÇÄ ‚à® a‚ÇÅ)
            Ôºù‚ü® ap (_‚à® a‚ÇÅ) (‚àß-comm ‚àô m) ‚àô ‚â§-max m ‚ü©
          a‚ÇÅ ‚àé

      lemma-assoc : ‚àÄ {a b c d e f}
                    ‚Üí a ‚àß d ‚àß f ‚à®
                      b ‚àß (c ‚àß f ‚à® d ‚àß e ‚à® c ‚àß e) ‚à® a ‚àß (c ‚àß f ‚à® d ‚àß e ‚à® c ‚àß e)
                    Ôºù
                        (a ‚àß d ‚à® b ‚àß c ‚à® a ‚àß c) ‚àß f
                      ‚à® (b ‚àß d) ‚àß e
                      ‚à® (a ‚àß d ‚à® b ‚àß c ‚à® a ‚àß c) ‚àß e
      lemma-assoc {a} {b} {c} {d} {e} {f}
        = (a ‚àß d ‚àß f ‚à®
           b ‚àß (c ‚àß f ‚à® d ‚àß e ‚à® c ‚àß e) ‚à® a ‚àß (c ‚àß f ‚à® d ‚àß e ‚à® c ‚àß e))
             Ôºù‚ü® ap (a ‚àß d ‚àß f ‚à®_)
                  (ap‚ÇÇ _‚à®_ distrib‚ÇÇ-‚àß-‚à® distrib‚ÇÇ-‚àß-‚à®) ‚ü©
           (a ‚àß d ‚àß f ‚à® ((b ‚àß c ‚àß f) ‚à® (b ‚àß d ‚àß e) ‚à® (b ‚àß c ‚àß e))
             ‚à® ((a ‚àß c ‚àß f) ‚à® (a ‚àß d ‚àß e) ‚à® a ‚àß c ‚àß e))
             Ôºù‚ü® ap (_ ‚à®_) (sym ‚à®-assoc ‚àô ap (_ ‚à®_) (‚à®-assoc
                                                    ‚àô ap (_‚à® (a ‚àß d ‚àß e ‚à® a ‚àß c ‚àß e))
                                                         ‚à®-comm
                                                    ‚àô sym ‚à®-assoc))
               ‚àô ‚à®-assoc ‚àô ‚à®-assoc
               ‚àô ap‚ÇÇ _‚à®_ (sym ‚à®-assoc ‚àô ap‚ÇÉ (Œª x y z ‚Üí x ‚à® (y ‚à® z)) ‚àß-assoc ‚àß-assoc ‚àß-assoc)
                         (ap‚ÇÇ _‚à®_ (ap‚ÇÇ _‚à®_ ‚àß-assoc ‚àß-assoc)
                                  (ap‚ÇÇ _‚à®_ ‚àß-assoc ‚àß-assoc)
                         ‚àô sym ‚à®-assoc ‚àô ap ((b ‚àß d) ‚àß e ‚à®_)
                                            (‚à®-assoc
                                            ‚àô ap (_‚à® (a ‚àß c) ‚àß e) ‚à®-comm
                                            ‚àô sym ‚à®-assoc)) ‚ü©
           (((a ‚àß d) ‚àß f ‚à® (b ‚àß c) ‚àß f ‚à® (a ‚àß c) ‚àß f) ‚à®
            (b ‚àß d) ‚àß e ‚à® (a ‚àß d) ‚àß e ‚à® (b ‚àß c) ‚àß e ‚à® (a ‚àß c) ‚àß e)
             Ôºù‚ü® sym (ap‚ÇÉ (Œª x y z ‚Üí x ‚à® (y ‚à® z)) distrib‚ÇÇ-‚àß-‚à®' refl distrib‚ÇÇ-‚àß-‚à®') ‚ü©
           ((a ‚àß d ‚à® b ‚àß c ‚à® a ‚àß c) ‚àß f
            ‚à® (b ‚àß d) ‚àß e
            ‚à® (a ‚àß d ‚à® b ‚àß c ‚à® a ‚àß c) ‚àß e)    ‚àé


    l : is-lattice (Lattice.0l L[x]) (Lattice.1l L[x])
                   (Lattice._‚àß_ L[x]) (Lattice._‚à®_ L[x])
    l .is-lattice.car-is-set = Œî‚ÇÅ-is-set
    l .is-lattice.‚àß-assoc {a , b} {c , d} {e , f}
      = Œî‚ÇÅ-ext (lemma-assoc , ‚àß-assoc)
    l .is-lattice.‚à®-assoc
      = Œî‚ÇÅ-ext (‚à®-assoc , ‚à®-assoc)
    l .is-lattice.‚àß-comm {(a‚ÇÄ , a‚ÇÅ) ‚¶É m ‚¶Ñ} {(b‚ÇÄ , b‚ÇÅ) ‚¶É n ‚¶Ñ}
      = Œî‚ÇÅ-ext (ap‚ÇÇ _‚à®_ ‚àß-comm (ap‚ÇÇ _‚à®_ ‚àß-comm ‚àß-comm)
                       ‚àô ‚à®-assoc ‚àô ap (_‚à® b‚ÇÄ ‚àß a‚ÇÄ) ‚à®-comm ‚àô sym ‚à®-assoc
               , ‚àß-comm)
    l .is-lattice.‚à®-comm
      = Œî‚ÇÅ-ext (‚à®-comm , ‚à®-comm)
    l .is-lattice.‚à®-‚àß-abs {(a‚ÇÄ , a‚ÇÅ) ‚¶É m ‚¶Ñ} {(b‚ÇÄ , b‚ÇÅ) ‚¶É n ‚¶Ñ}
      = Œî‚ÇÅ-ext (lemma2 , ‚à®-‚àß-abs)
    l .is-lattice.‚àß-‚à®-abs {(a‚ÇÄ , a‚ÇÅ) ‚¶É m ‚¶Ñ} {(b‚ÇÄ , b‚ÇÅ) ‚¶É n ‚¶Ñ}
      = Œî‚ÇÅ-ext (lemma3 , ‚àß-‚à®-abs)
    l .is-lattice.0-bottom
      = Œî‚ÇÅ-ext (0-bottom , 0-bottom)
    l .is-lattice.1-top {(a‚ÇÄ , a‚ÇÅ) ‚¶É m ‚¶Ñ}
      = Œî‚ÇÅ-ext (lemma1 , auto!)

  Œπ-const : A ‚Üí Œî¬≤ L
  Œπ-const x = (x , x)

  L[x]-is-lattice-algebra : is-lattice-hom L L[x] Œπ-const
  L[x]-is-lattice-algebra .is-lattice-hom.pres-‚à®
    = Œî‚ÇÅ-ext (refl , refl)
  L[x]-is-lattice-algebra .is-lattice-hom.pres-‚àß
    = Œî‚ÇÅ-ext ((sym (ap ((_ ‚àß _) ‚à®_)‚à®-idem ‚àô ‚à®-idem)) , refl)
  L[x]-is-lattice-algebra .is-lattice-hom.pres-0
    = Œî‚ÇÅ-ext (refl , refl)
  L[x]-is-lattice-algebra .is-lattice-hom.pres-1
    = Œî‚ÇÅ-ext (refl , refl)

  eval-polynomial : ‚àÄ {ùì§} {B : Type ùì§} (M : Lattice B) {i : A ‚Üí B}
                    ‚Üí is-lattice-algebra L M i
                    ‚Üí B ‚Üí Coslice-map Œπ-const i
  eval-polynomial M {i} ialg x .fst (a‚ÇÄ , a‚ÇÅ) = (i a‚ÇÄ M.‚àß x) M.‚à® i a‚ÇÅ
    where module M = Lattice M
  eval-polynomial M {i} ialg b .snd a = M.‚à®-comm ‚àô M.‚à®-‚àß-abs where
    module M = Lattice M

  eval-polynomial-is-alg-hom
    : ‚àÄ {ùì§} {B : Type ùì§} (M : Lattice B) (M-distr : is-distributive M) {i : A ‚Üí B}
    ‚Üí (ialg : is-lattice-algebra L M i)
    ‚Üí (b : B)
    ‚Üí is-lattice-alg-hom L L[x] L[x]-is-lattice-algebra
                           M ialg
                           (eval-polynomial M ialg b)
  eval-polynomial-is-alg-hom M Md {i} ialg x
    = l where
    module M = Lattice M
    open is-lattice-hom
    module Md = is-distributive  Md

    l : is-lattice-alg-hom L L[x] L[x]-is-lattice-algebra
                             M ialg
                             (eval-polynomial M ialg x)
    l .pres-0 = M.‚à®-comm ‚àô M.‚à®-‚àß-abs ‚àô ialg .pres-0
    l .pres-1 = M.‚à®-comm ‚àô M.‚à®-‚àß-abs ‚àô ialg .pres-1
    l .pres-‚à® {(a‚ÇÄ , a‚ÇÅ)} {(b‚ÇÄ , b‚ÇÅ)}
      = (‚åú i (a‚ÇÄ ‚à® b‚ÇÄ)‚åù M.‚àß x M.‚à® i (a‚ÇÅ ‚à® b‚ÇÅ))
         Ôºù‚ü® ap‚ÇÇ M._‚à®_ (ap! (ialg .pres-‚à®) ‚àô Md.distrib-‚àß-‚à®') (ialg .pres-‚à®) ‚ü©
        ((i a‚ÇÄ M.‚àß x M.‚à® i b‚ÇÄ M.‚àß x) M.‚à® i a‚ÇÅ M.‚à® i b‚ÇÅ)
          Ôºù‚ü® sym M.‚à®-assoc ‚ü©
        (i a‚ÇÄ M.‚àß x M.‚à® ‚åú i b‚ÇÄ M.‚àß x M.‚à® i a‚ÇÅ M.‚à® i b‚ÇÅ ‚åù)
          Ôºù‚ü® ap! (M.‚à®-assoc ‚àô ap‚ÇÇ M._‚à®_ M.‚à®-comm refl ‚àô sym M.‚à®-assoc)
            ‚àô M.‚à®-assoc ‚ü©
        ((i a‚ÇÄ M.‚àß x M.‚à® i a‚ÇÅ) M.‚à® i b‚ÇÄ M.‚àß x M.‚à® i b‚ÇÅ) ‚àé
    l .pres-‚àß {(a‚ÇÄ , a‚ÇÅ)} {(b‚ÇÄ , b‚ÇÅ)}
      = sym (Md.polynomial-mult' x
            ‚àô ap‚ÇÇ M._‚à®_ (ap (M._‚àß x)
                            (sym (ialg .pres-‚à®
                              ‚àô ap‚ÇÇ M._‚à®_ (ialg .pres-‚àß)
                                          (ialg .pres-‚à®
                                          ‚àô ap‚ÇÇ M._‚à®_ (ialg .pres-‚àß)
                                                      (ialg .pres-‚àß)))))
                        (sym (ialg .pres-‚àß)))


  L[x]-ev-algebra-hom
    : ‚àÄ {ùì§} {B : Type ùì§} {M : Lattice B} (Md : is-distributive M)
        {i : A ‚Üí B} (ialg : is-lattice-algebra L M i)
      ‚Üí B ‚Üí Œ£ _ (is-lattice-alg-hom L L[x] L[x]-is-lattice-algebra M ialg)
  L[x]-ev-algebra-hom Md ialg b
    = (eval-polynomial _ ialg b , eval-polynomial-is-alg-hom _ Md ialg b)

  L[x]-is-free-algebra
    : ‚àÄ {ùì§} {B : Type ùì§} {M : Lattice B} (Md : is-distributive M) {i : A ‚Üí B}
      ‚Üí (ialg : is-lattice-algebra L M i)
      ‚Üí is-equiv (L[x]-ev-algebra-hom Md ialg)
  L[x]-is-free-algebra {M = M} Md {i} ialg = is-equiv‚Üêqiso qiso where
    module M = Lattice M
    module L[x] = Lattice L[x]
    open is-lattice-hom

    qiso : quasi-iso (L[x]-ev-algebra-hom Md ialg)
    qiso .fst (map , ishom) = map .fst (1l , 0l) -- f ‚Ü¶ f(1)
    qiso .snd .fst b = ap ((i 1l M.‚àß _) M.‚à®_) (ialg .pres-0)
                     ‚àô M.0-bottom ‚àô M.‚àß-comm ‚àô ap (b M.‚àß_) (ialg .pres-1)
                     ‚àô M.1-top
    qiso .snd .snd ((f , K) , isalghom)
      = Œ£-path‚Üí (Œ£-path‚Üí (funext‚Üí H
              , funext‚Üí (Œª _ ‚Üí M.is-set-separated _ _ _ _))
              , (is-lattice-hom-is-prop L[x] M f _ _)) where
      H : ((a , b) : Œî¬≤ L) ‚Üí
           i a M.‚àß f (1l , 0l) M.‚à® i b Ôºù f (a , b)
      H ((a , b) ‚¶É p ‚¶Ñ)
        = (i a M.‚àß f (1l , 0l) M.‚à® i b)
             Ôºù‚ü® ap‚ÇÇ M._‚à®_ (ap (M._‚àß _) (sym (K a))) (sym (K b)) ‚ü©
          f (a , a) M.‚àß f (1l , 0l) M.‚à® f (b , b)      Ôºù‚ü® ap (M._‚à® _) (sym (isalghom .pres-‚àß)) ‚ü©
          (f ((a , a) L[x].‚àß (1l , 0l)) M.‚à® f (b , b)) Ôºù‚ü®‚ü©
          (f (((a ‚àß 0l ‚à® a ‚àß 1l ‚à® a ‚àß 1l) , (a ‚àß 0l)) ‚¶É _ ‚¶Ñ) M.‚à® f (b , b))
             Ôºù‚ü® ap (Œª x ‚Üí f x M.‚à® f (b , b))
                    (Œî‚ÇÅ-ext (ap (_ ‚à®_) ‚à®-idem ‚àô sym distrib-‚àß-‚à®
                            ‚àô ap (a ‚àß_) (‚à®-comm ‚àô 0-bottom) ‚àô auto!
                            , (‚àß-comm ‚àô 0-init))) ‚ü©
          (f (a , 0l) M.‚à® f (b , b))                   Ôºù‚ü® sym (isalghom .pres-‚à®) ‚ü©
          (f ((a , 0l) L[x].‚à® (b , b))) Ôºù‚ü®‚ü©
          f ((a ‚à® b) , (0l ‚à® b))
            Ôºù‚ü® ap f (Œî‚ÇÅ-ext ((‚à®-comm ‚àô ‚â§-max p) , ‚à®-comm ‚àô 0-bottom)) ‚ü©
          f (a , b) ‚àé
}
%```
}
