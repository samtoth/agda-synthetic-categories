\date{2025-02-21}
\title{Homotopies of functions}
\taxon{definition}

\import{stt-macros}

% ```agda
\agda{
module foundations.Homotopy where

open import foundations.Functions
open import foundations.universe
open import foundations.Identity
open import foundations.PathReasoning
}
% ```

\p{A homotopy between functions is a pointwise equality of functions.}

% ```agda
\agda{
infix 10 _~_
_~_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f g : (a : A) â†’ B a) â†’ Type (ğ“¤ âŠ” ğ“¥)
f ~ g = âˆ€ a â†’ f a ï¼ g a

}
% ```

\subtree{
\taxon{theorem}
\title{Homotopies are 2-cells in the #{(\infty, 1)}-category of types}

\proof{
% ```agda
\agda{

infixr 25 _~âˆ™_ 
_~âˆ™_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} 
     â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ {h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ h
(p ~âˆ™ q) a = p a âˆ™ q a


~refl : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f : (a : A) â†’ B a} â†’ f ~ f
~refl a = refl

~âˆ™-reflr : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ ~refl ~ p
~âˆ™-reflr p a = âˆ™-reflr (p a)


infix 20 _~â»Â¹
_~â»Â¹ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ {f g : (a : A) â†’ B a} â†’ f ~ g â†’ g ~ f 
(p ~â»Â¹) a = sym (p a)

~âˆ™-sym : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} {f g : (a : A) â†’ B a} â†’ (p : f ~ g) â†’ p ~âˆ™ (p ~â»Â¹) ~ ~refl
~âˆ™-sym p a = âˆ™-sym (p a)


_~âŸ¨âŸ©_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} (f : (a : A) â†’ B a) {g : (a : A) â†’ B a} â†’ f ~ g â†’ f ~ g
x ~âŸ¨âŸ© x~y = x~y
infixr 2 _~âŸ¨âŸ©_

~âŸ¨âŸ©-syntax : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) {g h : (a : A) â†’ B a} â†’ g ~ h â†’ f ~ g â†’ f ~ h
~âŸ¨âŸ©-syntax f p q = q ~âˆ™ p

infixr 2 ~âŸ¨âŸ©-syntax
syntax ~âŸ¨âŸ©-syntax x q p = x ~âŸ¨ p âŸ© q

infix  3 _~âˆ
_~âˆ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : A â†’ Type ğ“¥} â†’ (f : (a : A) â†’ B a) â†’ f ~ f
x ~âˆ = ~refl

infixr 25 _âŸ©~âˆ™âŸ¨_
_âŸ©~âˆ™âŸ¨_ : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} {p q : f ~ g} {h : A â†’ B} â†’ {r : g ~ h} {s : g ~ h}
       â†’ p ~ q â†’ r ~ s â†’ p ~âˆ™ r ~ q ~âˆ™ s
(p âŸ©~âˆ™âŸ¨ q) a = (p a) âŸ©âˆ™âŸ¨ (q a)


}
% ```
}
}

\p{We can define the whiskering of homotopies.}


% ```agda
\agda{

infixr 30 _â—‚_
_â—‚_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
    â†’ (h : B â†’ C) {f g : A â†’ B} â†’ f ~ g â†’ h âˆ˜ f ~ h âˆ˜ g
(h â—‚ p) x = ap h (p x)

infixl 31 _â–¸_
_â–¸_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
    â†’ {f g : B â†’ C} â†’ f ~ g â†’ (h : A â†’ B) â†’ f âˆ˜ h ~ g âˆ˜ h
(p â–¸ h) x = p (h x)


infixr 28 _âŸ©~â—‚âŸ¨_
_âŸ©~â—‚âŸ¨_ : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
           (f : B â†’ C) {g h : A â†’ B} {p q : g ~ h} â†’ p ~ q â†’ f â—‚ p ~ f â—‚ q
(f âŸ©~â—‚âŸ¨ p) a = ap (ap f) (p a)

}
% ```

% ```agda
\agda{

--     âŒœ ap (f âˆ˜ g âˆ˜ f) (Î· x) âˆ™ Îµ (f x)
-- =     Îµ (f (g (f x)))      âˆ™ ap f (Î· x)

--   f â—‚ g â—‚ f â—‚ Îµ
--   f â—‚ Îµ â–¸ g â–¸ f

--    Î· â–¸ f â–¸ g â–¸ f ~âˆ™ f â—‚ Îµ
--    f â—‚ g â—‚ f â—‚ Îµ ~âˆ™ Î· â–¸ f

homotopy-natural : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥} {f g : A â†’ B} â†’ (h : f ~ g)
                 â†’ âˆ€ {x y} (p : x ï¼ y) â†’ h x âˆ™ ap g p ï¼ ap f p âˆ™ h y  
homotopy-natural _ refl = âˆ™-reflr _

homotopy-inverse : âˆ€ {ğ“¤} {A : Type ğ“¤} (f : A â†’ A) (p : f ~ id) â†’ p â–¸ f ~ f â—‚ p
homotopy-inverse {ğ“¤} {A} f p x = p (f x)                ï¼âŸ¨ âˆ™.insertl A (âˆ™-sym (p x)) âŸ©
                         (p (f x) âˆ™ p x) âˆ™ sym (p x)    ï¼âŸ¨ II x âŸ©
                         (ap f (p x) âˆ™ p x) âˆ™ sym (p x) ï¼âŸ¨ âˆ™.cancell A (âˆ™-sym (p x)) âŸ©
                         ap f (p x) âˆ  where
  I : âˆ€ x â†’ p (f x) âˆ™ p x ï¼ ap f (p x) âˆ™ p x
  I x = homotopy-natural p (p x)

  -- funext I : p â–¸ f ~âˆ™ p ï¼ f â—‚ p ~âˆ™ p
  
  II : âˆ€ x â†’ (p (f x) âˆ™ p x) âˆ™ sym (p x) ï¼ (ap f (p x) âˆ™ p x) âˆ™ sym (p x)
  II x = ap (_âˆ™ sym (p x)) (I x)
}
% ```
