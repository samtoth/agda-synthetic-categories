\title{(Pre)Postwhiskering}
\date{2025-06-26}
\author{samueltoth}
\taxon{Module}
\import{stt-macros}

%```agda
\agda{
module Core.Postwhisker where

open import Foundations.Prelude
open import ufAxioms
open import Core.Arrow
open import Core.ArrowEquiv
}
%```


\subtree[stt-006G]{
\title{Postwhiskering a homotopy}
\taxon{Definition}


%```agda
\agda{
prewhisker : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
                {X : Type ğ“¦} (f : A â†’ B)
                (g h : B â†’ X)
              â†’ g ~ h â†’ g âˆ˜ f ~ h âˆ˜ f
prewhisker f g h = _â–¸ f

postwhisker : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
               {X : Type ğ“¦} (f : A â†’ B)
               (g h : X â†’ A)
             â†’ g ~ h â†’ f âˆ˜ g ~ f âˆ˜ h
postwhisker f g h = f â—‚_
}
%```
}


\subtree[stt-006I]{
\title{Funext for Postwhsikering}
\taxon{Theorem}

\p{Let #{f : A \to B}, and #{g,h : B \to C}, then
postwhiskering by #{f} is an equivalence iff #{\rm{ap}_{{-} \circ f}^{g,h}} is.}

%```agda
\agda{
prewhiskerâ†ap-compose
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
      (f : A â†’ B) (g h : B â†’ C)
    â†’ Arrow-map (ap (precomp C f) {g} {h}) (prewhisker f g h)
prewhiskerâ†ap-compose _ _ _ .Arrow-map.top = happly
prewhiskerâ†ap-compose _ _ _ .Arrow-map.bot = happly
prewhiskerâ†ap-compose _ _ _ .Arrow-map.comm refl = refl

prewhisker-funext
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
      {f : A â†’ B} {g h : B â†’ C}
    â†’ is-Arrow-equiv (prewhiskerâ†ap-compose f g h)
prewhisker-funext .fst = global-funext
prewhisker-funext .snd = global-funext


prewhisker-is-equivâ†ap-compose
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
      {C : Type ğ“¦}
      {f : A â†’ B}
      {g h : B â†’ C}
    â†’ is-equiv (ap (precomp C f) {g} {h})
    â†’ is-equiv (prewhisker f g h)
prewhisker-is-equivâ†ap-compose e
  = is-equivâ†Arrow-equiv {F = prewhiskerâ†ap-compose _ _ _}
                         prewhisker-funext
                         e
}
%```
}

\subtree[stt-00B4]{
\title{Precomposing commutes with funext}
\taxon{Lemma}

%```agda
\agda{
commutes-prewhisker-funext
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {Q : Type ğ“¦}
      {f : Q â†’ A} {g h : A â†’ B}
    â†’ funextâ†’ âˆ˜ prewhisker f g h ~ ap (precomp B f) âˆ˜ funextâ†’
commutes-prewhisker-funext = funext-rec _ Î»
  where refl â†’ funext-refl âˆ™ sym (ap (ap _) funext-refl)

commutes-postwhisker-funext
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {Q : Type ğ“¦}
      {f g : Q â†’ A} {h : A â†’ B}
    â†’ funextâ†’ âˆ˜ postwhisker h f g ~ ap (postcomp Q h) âˆ˜ funextâ†’
commutes-postwhisker-funext = funext-rec _ Î»
  where refl â†’ funext-refl âˆ™ sym (ap (ap _) funext-refl)
}
%```
}

\subtree[stt-006H]{
\title{Prewhiskering by an equiavalence is an equivalence}
\taxon{Corollary}

%```agda
\agda{
opaque
  prewhisker-equiv-is-equiv
    : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥}
        {f : A â†’ B} â†’ is-equiv f
      â†’ âˆ€ {C : Type ğ“¦} {g h : B â†’ C}
        â†’ is-equiv (prewhisker f g h)
  prewhisker-equiv-is-equiv e
    = prewhisker-is-equivâ†ap-compose
       (is-embeddingâ†is-equiv (precomp-equiv e))
}
%```
}
