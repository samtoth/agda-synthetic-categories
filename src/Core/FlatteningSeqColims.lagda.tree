\title{Flattening for Sequential Colimits}
\author{samueltoth}
\date{2025-08-19}
\taxon{module}
\meta{module}{Core.FlatteningSeqColims}
\import{stt-macros}

%```agda
\agda{
module Core.FlatteningSeqColims where

open import Foundations.Prelude
open import ufAxioms

open import Core.CanonicalPushouts
open import Core.Coequalisers
open import Core.CanonicalSeqColims
open import Core.FlatteningCoequalisers
}
%```


\subtree[stt-009I]{
\title{Flatteninig for sequential colimits}
\taxon{theorem}

%```agda
\agda{
module _ {ğ“¤ ğ“¥} {S : Incr-seq ğ“¤} (P : Seq-colimit S â†’ Type ğ“¥) where
  open Incr-seq S
  total-seq : Incr-seq (ğ“¤ âŠ” ğ“¥)
  total-seq .Incr-seq.Point n = Î£ (Point n) (P âˆ˜ Î¹-seq S)
  total-seq .Incr-seq.incr (a , b) = (incr a , tr P (glue-suc S a) b)

  total-seq-cocone : Cocone-seq total-seq (Î£ _ P)
  total-seq-cocone .Cocone-seq.Î¹ (a , b) = (Î¹-seq S a , b)
  total-seq-cocone .Cocone-seq.comm (a , b)
    = Î£-pathâ†’ (glue-suc S a , refl)

  LL : id {A = Î£[ n âˆ¶ â„• ] Î£ (Point n) (P âˆ˜ Î¹-seq S)}
    ~ Î£-assoc ._â‰ƒ_.fwd âˆ˜ total-map (Î» p â†’ tr P (sym (glue-suc S (p .snd)))) âˆ˜ (total-map (Î» p â†’ tr P (glue-suc S (p .snd))) âˆ˜ _â‰ƒ_.bwd Î£-assoc)
  LL (n , (p , pp))
    = Î£-pathâ†’
        ( refl
        , (Î£-pathâ†’
          ( refl
          , sym (trâˆ™tr-sym (glue-suc S p) pp)
          )))

  RR : Incr-seq.incrÎ£ total-seq ~ Î£-assoc ._â‰ƒ_.fwd âˆ˜ total-map-fst incrÎ£ âˆ˜ (total-map (Î» p â†’ tr P (glue-suc S (p .snd))) âˆ˜ _â‰ƒ_.bwd Î£-assoc)
  RR (n , (p , pp)) = refl

  total-seq-colimâ‰ƒ : Î£ _ P â‰ƒ Seq-colimit total-seq
  total-seq-colimâ‰ƒ
    = Î£ _ P                              â‰ƒâŸ¨ total-forkâ‰ƒ _ _ P âŸ©
      Coeq (total-maps id incrÎ£ P .fst)
           (total-maps id incrÎ£ P .snd)  â‰ƒâŸ¨âŸ©
      Coeq (total-map (Î» a â†’ tr P (sym (glue-suc _ _))))
           (total-map-fst incrÎ£)         â‰ƒâŸ¨ precomp-coeqâ‰ƒ (is-equiv-âˆ˜ (is-total-equivâ†is-fibrewise-equiv (Î» a â†’ tr-is-equiv (glue-suc S (a .snd)))) (is-equivâ»Â¹ (Î£-assoc ._â‰ƒ_.has-is-eqv))) eâ»Â¹ âŸ©
      Coeq _ _                           â‰ƒâŸ¨ postcomp-coeqâ‰ƒ~ (Î£-assoc ._â‰ƒ_.has-is-eqv) LL RR âŸ©
      Coeq id (Incr-seq.incrÎ£ total-seq) â‰ƒâŸ¨âŸ©
      Seq-colimit total-seq â‰ƒâˆ

  -- Î£-is-seq-colim : is-seq-colim total-seq total-seq-cocone
  -- Î£-is-seq-colim = {!!}
}
%```
}
