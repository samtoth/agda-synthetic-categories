\title{Extensions}
\taxon{Module}
\author{samueltoth}
\date{2025-12-19}
\import{stt-macros}


%```agda
\agda{
module Foundations.Extension where


open import Foundations.Universes
open import Foundations.Identity
open import Foundations.Functions
open import Foundations.Empty
open import Foundations.Unit
open import Foundations.Homotopy
open import Foundations.Sigma
open import Foundations.SigmaProperties
open import Foundations.FibrewiseEquiv
open import Foundations.CoherentIsomorphism
open import Foundations.IdentityEquiv
open import Foundations.Singleton
open import Foundations.EmptyUP
open import Foundations.FunExt
open import Foundations.SingletonClosure
}
%```

\subtree[stt-00CL]{
\taxon{Definition}
\title{Extension types}


\p{Given a map #{i : A \to B}, and a map #{p : A \to X},
which when #{i} is an embedding we consider a partial element of #{X}, we consider
the type of maps #{B \to X} which agree with #{p} in the sense that the following
triangle commutes: }

\quiver{
\begin{tikzcd}[cramped]
	&& X \\
	\\
	A && B
	\arrow["p", from=3-1, to=1-3]
	\arrow["i"', from=3-1, to=3-3]
	\arrow["f"', from=3-3, to=1-3]
\end{tikzcd}
}

\p{The type of extensions of #{p} along #{i} is exactly the fibres of the map
#{i^* : X^B \to X^A} at #{p}. We can also generalise this to a dependent
type #{X} over #{B}.}

%```agda
\agda{
Ext : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} (i : A â†’ B)
        {X : B â†’ Type ğ“¦} (p : Î  A (X âˆ˜ i)) â†’ Type (ğ“¤ âŠ” ğ“¥ âŠ” ğ“¦)
Ext i {X} p = fibre (postcomp-Î  X i) p

Ext-Idâ†’
  : âˆ€ {ğ“¤ ğ“¥ ğ“¦} {A : Type ğ“¤} {B : Type ğ“¥} {i j : A â†’ B} (H : i ï¼ j)
      {X : Type ğ“¦} (p : A â†’ X) â†’ Ext j p â†’ Ext i p
Ext-Idâ†’ H p = total-map (Î» a â†’ ap (a âˆ˜_) H âˆ™_)

Ext-âˆ…
  : âˆ€ {ğ“¤ ğ“¥} {A : Type ğ“¤} {B : Type ğ“¥}
    â†’ FunExt-global â†’ Ext {B = A} Â¡_ {Î» _ â†’ B} Â¡_ â‰ƒ (A â†’ B)
Ext-âˆ… FE = mkâ‰ƒ fst (singleton-fst-is-equiv Î» x â†’ Singleton-Id (âˆ…-UP-sing FE) _ _)
}
%```
}

\subtree[stt-00CM]{
\title{Composition of extension}
\taxon{Lemma}

\p{Given a diagram as follows:}

\quiver{
\begin{tikzcd}
	&&&& Q \\
	\\
	\\
	A && B && C
	\arrow["p", from=4-1, to=1-5]
	\arrow["i"', from=4-1, to=4-3]
	\arrow[dashed, from=4-3, to=1-5]
	\arrow["j"', from=4-3, to=4-5]
	\arrow[dashed, from=4-5, to=1-5]
\end{tikzcd}
}

\p{We show that an extension of #{p} along #{ji} is equivalent to the pair
of an extension #{f} of #{p} along #{i} together with an extension of #{f}
along #{j}.
}

\proof{
\p{By contracting singletons.}
}

%```agda
\agda{
Ext-compose : âˆ€ {ğ“¤ ğ“¥ ğ“¦ ğ“œ} {A : Type ğ“¤} {B : Type ğ“¥} {C : Type ğ“¦}
                (j : B â†’ C) (i : A â†’ B) {X : Type ğ“œ} (p : A â†’ X )
              â†’ Ext (j âˆ˜ i) p â‰ƒ (Î£[ f âˆ¶ Ext i p ] (Ext j (f .fst)))
Ext-compose {A = A}{B}{C} j i {X} p
  = Ext (j âˆ˜ i) p                       â‰ƒâŸ¨âŸ©
    (Î£[ g âˆ¶ (C â†’ X) ] (g âˆ˜ j âˆ˜ i ï¼ p)) â‰ƒâŸ¨ Î£-ap-â‰ƒ (Î» g â†’ Î£-ï¼singl' eâ»Â¹) âŸ©
    (Î£[ g âˆ¶ (C â†’ X) ] Î£[ f âˆ¶ (B â†’ X)] ((g âˆ˜ j ï¼ f) Ã— (g âˆ˜ j âˆ˜ i ï¼ p)))
                                        â‰ƒâŸ¨ Î£-comm âˆ™â‰ƒ Î£-assoc eâ»Â¹
                                         âˆ™â‰ƒ Î£-ap-â‰ƒ (Î» a
                                           â†’ Î£-ap-â‰ƒ (Î» where refl â†’ idequiv)
                                             âˆ™â‰ƒ Ã—-swap)
                                             âŸ©
    (Î£[ (f , g) âˆ¶ (B â†’ X) Ã— (C â†’ X) ] ((f âˆ˜ i ï¼ p) Ã— (g âˆ˜ j ï¼ f)))
                                        â‰ƒâŸ¨ Î£-interchange âŸ©
    (Î£[ (f , H) âˆ¶ Î£[ f âˆ¶ (B â†’ X)] (f âˆ˜ i ï¼ p) ] Î£[ g âˆ¶ (C â†’ X) ] (g âˆ˜ j ï¼ f))
                                        â‰ƒâŸ¨âŸ©
    (Î£[ f âˆ¶ Ext i p ] Ext j (f .fst))   â‰ƒâˆ
}
%```
}
